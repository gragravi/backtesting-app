(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function r(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(t){if(t.ep)return;t.ep=!0;const n=r(t);fetch(t.href,n)}})();async function x(o){try{const e=await fetch(o);if(!e.ok)throw new Error(`Erreur HTTP: ${e.status}`);const i=(await e.text()).trim().split(`
`);i.shift();const t=i.map((n,s)=>{try{if(!n||n.trim()==="")return null;const[l,g,m,h,y]=n.split(",");if(!l||!g||!m||!h||!y)throw new Error("Ligne mal form√©e, donn√©es manquantes.");const[$,B]=l.split(" "),[C,w,S]=$.split("."),[b,D]=B.split(":");if(!C||!w||!S||!b||!D)throw new Error("Format de date invalide.");const O=`${S}-${w}-${C}T${b}:${D}:00Z`,U=new Date(O),E=Math.floor(U.getTime()/1e3),v=parseFloat(g),L=parseFloat(m),N=parseFloat(h),T=parseFloat(y);if(isNaN(E)||isNaN(v)||isNaN(L)||isNaN(N)||isNaN(T))throw new Error("Valeur non num√©rique (NaN) d√©tect√©e.");return{time:E,open:v,high:L,low:N,close:T}}catch(l){return console.warn(`‚ö†Ô∏è Ligne CSV invalide (n¬∞${s+2}) ignor√©e. Raison: ${l.message}`),null}}).filter(Boolean);return t.length===0&&i.length>0?console.error("‚ùå Aucune donn√©e valide n'a pu √™tre extraite du CSV."):console.log(`‚úÖ Fichier CSV pars√© : ${t.length} bougies valides charg√©es.`),t}catch(e){return console.error("‚ùå Erreur majeure lors du parsing du fichier CSV:",e),[]}}let c=null,d=null,a=null;const u={initChart(o){const e=document.getElementById(o);if(!e){console.error(`‚ùå L'√©l√©ment conteneur #${o} n'a pas √©t√© trouv√©.`);return}c=LightweightCharts.createChart(e,{width:e.clientWidth,height:e.clientHeight,layout:{background:{color:"#ffffff"},textColor:"#222222"},grid:{vertLines:{color:"#eeeeee"},horzLines:{color:"#eeeeee"}},timeScale:{timeVisible:!0,secondsVisible:!1}}),d=c.addCandlestickSeries({upColor:"#2ebd85",downColor:"#e74c3c",borderUpColor:"#2ebd85",borderDownColor:"#e74c3c",wickUpColor:"#2ebd85",wickDownColor:"#e74c3c",priceFormat:{type:"price",precision:5,minMove:1e-5}}),console.log("‚úÖ Moteur TradingView (base stable) initialis√©."),new ResizeObserver(r=>{if(r.length>0&&r[0].contentRect.width>0){const{width:i,height:t}=r[0].contentRect;c.resize(i,t)}}).observe(e)},setSeriesData(o){if(!d){console.error("‚ùå La s√©rie de bougies n'est pas initialis√©e.");return}d.setData(o),a=o,console.log("‚úÖ Donn√©es inject√©es dans le graphique."),c.timeScale().fitContent()},getLatestPrice(){return a&&a.length>0?a[a.length-1].close:null}},f="EURUSD",p="data/EURUSD_M1_BID_2020-2025.csv",I="chart-container";function P(o,e){const r={EURUSD:"üá™üá∫üá∫üá∏",USDJPY:"üá∫üá∏üáØüáµ",GBPUSD:"üá¨üáßüá∫üá∏",BTCUSD:"‚Çøüá∫üá∏"};document.getElementById("pair-flags").textContent=r[o],document.getElementById("symbol-name").textContent=o,e?document.getElementById("symbol-price").textContent=e.toFixed(5):document.getElementById("symbol-price").textContent="---"}async function R(){console.log("üöÄ Initialisation de l'application (version stable)..."),u.initChart(I),console.log(`‚è≥ Chargement des donn√©es pour ${f} depuis ${p}...`);const o=await x(p);if(o&&o.length>0){console.log("‚è≥ Tri des donn√©es chronologiques..."),o.sort((r,i)=>r.time-i.time),u.setSeriesData(o);const e=u.getLatestPrice();P(f,e)}else console.error(`‚ùå Aucune donn√©e n'a √©t√© charg√©e depuis ${p}.`),P(f,null);document.getElementById("replay-btn").onclick=e=>{e.preventDefault(),console.log("Bouton Replay cliqu√© (fonctionnalit√© d√©sactiv√©e temporairement).")}}document.addEventListener("DOMContentLoaded",R);
